import{s as T,r as d,j as e,d as g,e as b}from"./index-BOLkSH9S.js";import{D as O,P as D}from"./DashboardLayout-BvCakflT.js";import{L as S}from"./loader-circle-MnlzbvQH.js";import{C as L}from"./circle-question-mark-CVrBAAd0.js";import{H as M}from"./hash-BXP-0cEx.js";import{C as I}from"./circle-check-big-DahogGvV.js";import{C as R}from"./star-C1ESBnNj.js";import{P as U}from"./pen-BRCIE4vx.js";import{T as B}from"./trash-2-Euhy1XCH.js";import{C as H}from"./chevron-left-B0iQB9Pm.js";import{C as G}from"./package-CKJSu7qp.js";import{C as J}from"./circle-x-Bxs6Jh5B.js";import"./Logo-g0xKsfJ_.js";import"./x-C2LEswAj.js";import"./createLucideIcon-Df3o3GTg.js";import"./house-CbQ0kLy2.js";import"./users-B4SWA-Gw.js";import"./file-check-CwXOnyIx.js";import"./shield-check-BosUqYmL.js";import"./message-circle-BHYE61eq.js";import"./file-text-CticlOFV.js";import"./user-CozA4sKy.js";import"./BackgroundArt-ChQV54k0.js";const o="https://agrimeetbackend.agrimeetconnect.com/api/v1",z=()=>T.getAccessToken()||"",c=(t=!0)=>{const r={Authorization:`Bearer ${z()}`,Accept:"application/json"};return t&&(r["Content-Type"]="application/json"),r},m=async t=>{if(!t.ok){let r;try{r=await t.json()}catch{r={message:"An unknown error occurred."}}const i=new Error(r.message||`Error ${t.status}`);throw i.status=t.status,i.data=r,i}return t.status===204?null:t.json()},X=(t={})=>{const r=Object.fromEntries(Object.entries(t).filter(([x,a])=>a!=null&&a!=="")),i=new URLSearchParams(r).toString();return i?`?${i}`:""},h={async getAll(t={}){const r=X(t),i=await fetch(`${o}/admin/faqs${r}`,{method:"GET",headers:c()});return m(i)},async getById(t){const r=await fetch(`${o}/admin/faqs/${t}`,{method:"GET",headers:c()});return m(r)},async create(t){const r=await fetch(`${o}/admin/faqs`,{method:"POST",headers:c(),body:JSON.stringify(t)});return m(r)},async update(t,r){const i=await fetch(`${o}/admin/faqs/${t}`,{method:"PUT",headers:c(),body:JSON.stringify(r)});return m(i)},async delete(t){const r=await fetch(`${o}/admin/faqs/${t}`,{method:"DELETE",headers:c()});return m(r)},async publish(t){const r=await fetch(`${o}/admin/faqs/${t}/publish`,{method:"POST",headers:c()});return m(r)},async unpublish(t){const r=await fetch(`${o}/admin/faqs/${t}/unpublish`,{method:"POST",headers:c()});return m(r)},async reorder(t){const r=await fetch(`${o}/admin/faqs/reorder`,{method:"POST",headers:c(),body:JSON.stringify({faqs:t})});return m(r)}},ye=()=>{const[t,r]=d.useState([]),[i,x]=d.useState(!0),[a,k]=d.useState({current_page:1,last_page:1,total:0}),[F,N]=d.useState(!1),[v,_]=d.useState(!1),[y,f]=d.useState(null),[l,u]=d.useState({question:"",answer:"",order:0,is_published:!1}),p=async(s=1)=>{try{x(!0);const n=await h.getAll({page:s}),w=(n.data||[]).sort((P,q)=>P.order-q.order);r(w),k({current_page:n.current_page||1,last_page:n.last_page||1,total:n.total||0})}catch(n){console.error("Failed to fetch FAQs:",n),g("Failed to load FAQs")}finally{x(!1)}};d.useEffect(()=>{p()},[]);const C=(s=null)=>{if(s)f(s.id),u({question:s.question,answer:s.answer,order:s.order||0,is_published:!!s.is_published});else{f(null);const n=t.length>0?Math.max(...t.map(w=>w.order)):-1;u({question:"",answer:"",order:n+1,is_published:!1})}N(!0)},j=()=>{N(!1),f(null),u({question:"",answer:"",order:0,is_published:!1})},Q=async s=>{if(s.preventDefault(),!l.question.trim()||!l.answer.trim()){g("Question and Answer are required");return}try{_(!0),y?(await h.update(y,l),b("FAQ updated successfully")):(await h.create(l),b("FAQ created successfully")),j(),p(a.current_page)}catch(n){g(n.message||"Operation failed")}finally{_(!1)}},$=async s=>{if(window.confirm("Are you sure you want to delete this FAQ?"))try{x(!0),await h.delete(s),b("FAQ deleted successfully"),p(a.current_page)}catch(n){g(n.message||"Failed to delete"),x(!1)}},E=async s=>{try{s.is_published?(await h.unpublish(s.id),b("Unpublished successfully")):(await h.publish(s.id),b("Published successfully")),p(a.current_page)}catch(n){g(n.message||"Failed to update status")}},A=s=>{s>=1&&s<=a.last_page&&p(s)};return e.jsxs(O,{children:[e.jsxs("div",{className:"md:p-6 p-1 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"FAQ Management"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage frequently asked questions and answers"})]}),e.jsxs("button",{onClick:()=>C(),className:"flex items-center justify-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{children:"Add New FAQ"})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:i?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{className:"w-8 h-8 text-brand-600 animate-spin"})}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(L,{className:"w-6 h-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No FAQs found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Get started by creating your first question."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600 w-16",children:e.jsx("div",{className:"flex items-center gap-1",children:e.jsx(M,{className:"w-3 h-3"})})}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600 w-1/3",children:"Question"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600",children:"Answer Preview"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600",children:"Status"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-xs text-gray-500 font-mono",children:s.order}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-xs text-gray-900 font-medium align-top",children:s.question}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3  text-gray-600 align-top",children:e.jsx("div",{className:"line-clamp-2 max-w-md text-xs text-gray-500",children:s.answer})}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-xs align-top",children:e.jsxs("button",{onClick:()=>E(s),className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border cursor-pointer transition-all ${s.is_published?"bg-green-50 text-green-700 border-green-200 hover:bg-green-100":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:[s.is_published?e.jsx(I,{className:"w-3.5 h-3.5"}):e.jsx(R,{className:"w-3.5 h-3.5"}),s.is_published?"Published":"Draft"]})}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-xs text-right align-top",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>C(s),className:"p-2 text-gray-400 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(U,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>$(s.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(B,{className:"w-4 h-4"})})]})})]},s.id))})]})}),a.last_page>1&&e.jsxs("div",{className:"md:px-6 md:py-4 px-4 py-3 border-t border-gray-100 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",a.current_page," of ",a.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>A(a.current_page-1),disabled:a.current_page<=1,className:"p-2 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(H,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>A(a.current_page+1),disabled:a.current_page>=a.last_page,className:"p-2 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(G,{className:"w-4 h-4"})})]})]})]})})]}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:y?"Edit FAQ":"Create New FAQ"}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(J,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:Q,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question"}),e.jsx("input",{type:"text",required:!0,maxLength:500,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 text-sm p-2.5 border",placeholder:"e.g., How do I reset my password?",value:l.question,onChange:s=>u({...l,question:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer"}),e.jsx("textarea",{required:!0,rows:6,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 text-sm p-3 border",placeholder:"Enter the detailed answer here...",value:l.answer,onChange:s=>u({...l,answer:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Display Order"}),e.jsx("input",{type:"number",min:"0",className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 text-sm p-2.5 border",value:l.order,onChange:s=>u({...l,order:parseInt(s.target.value)||0})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Lower numbers appear first"})]}),e.jsx("div",{className:"flex items-end pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"is_published",className:"rounded border-gray-300 text-brand-600 focus:ring-brand-500 h-5 w-5",checked:l.is_published,onChange:s=>u({...l,is_published:s.target.checked})}),e.jsx("label",{htmlFor:"is_published",className:"text-sm font-medium text-gray-700 select-none cursor-pointer",children:"Publish immediately"})]})})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-100 mt-4",children:[e.jsx("button",{type:"button",onClick:j,className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:v,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-bold text-white bg-brand-600 rounded-lg hover:bg-brand-700 transition-colors disabled:opacity-70",children:[v&&e.jsx(S,{className:"w-4 h-4 animate-spin"}),y?"Update FAQ":"Create FAQ"]})]})]})]})})]})};export{ye as default};
