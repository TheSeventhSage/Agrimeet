import{s as T,r as l,j as e,d as u,e as g}from"./index-C7G52Pl0.js";import{D as F,P as L}from"./DashboardLayout-BvYMyTkM.js";import{L as _}from"./loader-circle-Cvar0TnB.js";import{F as O}from"./file-text-XKYnme41.js";import{C as I}from"./circle-check-big-28D-GMzn.js";import{C as S}from"./circle-x-DQ-cXR03.js";import{C as U}from"./calendar-CiJPG-0y.js";import{P as M}from"./pen-0gpzGqQc.js";import{T as q}from"./trash-2-yhPGZUjZ.js";import"./Logo-DmsMbJO2.js";import"./x-B7cmv6PP.js";import"./createLucideIcon-BK9ndVRo.js";import"./package-DupdcTls.js";import"./house-D2YIMOjc.js";import"./users-BmFRYmpR.js";import"./file-check-CHEU1kxb.js";import"./shield-check-DG8ZUOrZ.js";import"./circle-question-mark-DtC5Y68d.js";import"./star-C80gymXW.js";import"./message-circle-CLbYCCGy.js";import"./user-CwMqLLM3.js";import"./BackgroundArt-Ct9Pe-Iv.js";const c="https://agrimeetbackend.agrimeetconnect.com/api/v1",G=()=>T.getAccessToken()||"",d=(s=!0)=>{const r={Authorization:`Bearer ${G()}`,Accept:"application/json"};return s&&(r["Content-Type"]="application/json"),r},m=async s=>{if(!s.ok){let r;try{r=await s.json()}catch{r={message:"An unknown error occurred."}}const n=new Error(r.message||`Error ${s.status}`);throw n.status=s.status,n.data=r,n}return s.status===204?null:s.json()},R=(s={})=>{const r=Object.fromEntries(Object.entries(s).filter(([b,a])=>a!=null&&a!=="")),n=new URLSearchParams(r).toString();return n?`?${n}`:""},x={async getAll(s={}){const r=R(s),n=await fetch(`${c}/admin/privacy-policies${r}`,{method:"GET",headers:d()});return m(n)},async get(s){const r=await fetch(`${c}/admin/privacy-policies/${s}`,{method:"GET",headers:d()});return m(r)},async create(s){const r=await fetch(`${c}/admin/privacy-policies`,{method:"POST",headers:d(),body:JSON.stringify(s)});return m(r)},async update(s,r){const n=await fetch(`${c}/admin/privacy-policies/${s}`,{method:"PUT",headers:d(),body:JSON.stringify(r)});return m(n)},async delete(s){const r=await fetch(`${c}/admin/privacy-policies/${s}`,{method:"DELETE",headers:d()});return m(r)},async publish(s){const r=await fetch(`${c}/admin/privacy-policies/${s}/publish`,{method:"POST",headers:d()});return m(r)},async unpublish(s){const r=await fetch(`${c}/admin/privacy-policies/${s}/unpublish`,{method:"POST",headers:d()});return m(r)}},pe=()=>{const[s,r]=l.useState([]),[n,b]=l.useState(!0),[a,C]=l.useState({current_page:1,last_page:1,total:0}),[k,N]=l.useState(!1),[w,v]=l.useState(!1),[y,f]=l.useState(null),[o,h]=l.useState({content:"",is_published:!1}),p=async(t=1)=>{try{b(!0);const i=await x.getAll({page:t,per_page:10});r(i.data||[]),C({current_page:i.current_page||1,last_page:i.last_page||1,total:i.total||0})}catch(i){console.error("Fetch error:",i),u("Failed to load privacy policies.")}finally{b(!1)}};l.useEffect(()=>{p()},[]);const P=(t=null)=>{t?(f(t.id),h({content:t.content,is_published:!!t.is_published})):(f(null),h({content:"",is_published:!1})),N(!0)},j=()=>{N(!1),f(null),h({content:"",is_published:!1})},$=async t=>{if(t.preventDefault(),!o.content.trim()){u("Policy content is required.");return}v(!0);try{y?(await x.update(y,o),g("Policy updated successfully.")):(await x.create(o),g("Policy created successfully.")),j(),p(a.current_page)}catch(i){console.error("Submit error:",i),u(i.message||"Operation failed.")}finally{v(!1)}},E=async t=>{if(window.confirm("Are you sure you want to delete this policy?"))try{await x.delete(t),g("Policy deleted successfully."),p(a.current_page)}catch{u("Failed to delete policy.")}},A=async t=>{const i=t.is_published?"unpublish":"publish";if(window.confirm(`Are you sure you want to ${i} this policy?`))try{t.is_published?await x.unpublish(t.id):await x.publish(t.id),g(`Policy ${i}ed successfully.`),p(a.current_page)}catch{u(`Failed to ${i} policy.`)}},D=t=>t?new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsxs(F,{children:[e.jsxs("div",{className:"p-1 lg:p-4 space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Privacy Policies"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Create and manage your application's privacy policies."})]}),e.jsxs("button",{onClick:()=>P(),className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors shadow-sm",children:[e.jsx(L,{className:"w-5 h-5"}),"Create New Policy"]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[n?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(_,{className:"w-8 h-8 text-brand-600 animate-spin mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Loading policies..."})]}):s.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"bg-gray-100 p-4 rounded-full w-fit mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No Policies Found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Get started by creating your first privacy policy."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 md:px-6 md:py-4 text-sm font-semibold text-gray-900",children:"ID"}),e.jsx("th",{className:"px-4 py-3 md:px-6 md:py-4 text-sm font-semibold text-gray-900",children:"Content Preview"}),e.jsx("th",{className:"px-4 py-3 md:px-6 md:py-4 text-sm font-semibold text-gray-900",children:"Status"}),e.jsx("th",{className:"px-4 py-3 md:px-6 md:py-4 text-sm font-semibold text-gray-900",children:"Last Updated"}),e.jsx("th",{className:"px-4 py-3 md:px-6 md:py-4 text-sm font-semibold text-gray-900 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-4 py-3 md:px-6 md:py-4 text-sm text-gray-500",children:["#",t.id]}),e.jsx("td",{className:"px-4 py-3 md:px-6 md:py-4",children:e.jsx("p",{className:"text-sm text-gray-900 line-clamp-2 max-w-md",children:t.content})}),e.jsx("td",{className:"px-4 py-3 md:px-6 md:py-4",children:e.jsx("button",{onClick:()=>A(t),className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border cursor-pointer transition-colors
                                                        ${t.is_published?"bg-green-50 text-green-700 border-green-200 hover:bg-green-100":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:t.is_published?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-3.5 h-3.5"})," Published"]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"w-3.5 h-3.5"})," Draft"]})})}),e.jsx("td",{className:"px-4 py-3 md:px-6 md:py-4 text-xs text-gray-600 ",children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(U,{className:"w-4 h-4 text-gray-400"}),D(t.updated_at||t.created_at)]})}),e.jsx("td",{className:"px-4 py-3 md:px-6 md:py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>P(t),className:"p-2 text-gray-500 hover:text-brand-600 hover:bg-brand-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(t.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(q,{className:"w-4 h-4"})})]})})]},t.id))})]})}),a.last_page>1&&e.jsxs("div",{className:"px-4 py-3 md:px-6 md:py-4 border-t border-gray-200 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",a.current_page," of ",a.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{disabled:a.current_page===1,onClick:()=>p(a.current_page-1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50 disabled:opacity-50",children:"Previous"}),e.jsx("button",{disabled:a.current_page===a.last_page,onClick:()=>p(a.current_page+1),className:"px-3 py-1 text-sm border rounded hover:bg-gray-50 disabled:opacity-50",children:"Next"})]})]})]})]}),k&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-3 md:px-6 md:py-4 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:y?"Edit Privacy Policy":"Create Privacy Policy"}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600",children:e.jsx(S,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:$,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Policy Content"}),e.jsx("textarea",{value:o.content,onChange:t=>h({...o,content:t.target.value}),required:!0,rows:10,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-brand-500 focus:border-brand-500 outline-none transition-all resize-y",placeholder:"Enter the details of the privacy policy here..."}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Supports plain text. For rich text, please integrate a WYSIWYG editor."})]}),e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsx("input",{type:"checkbox",id:"is_published",checked:o.is_published,onChange:t=>h({...o,is_published:t.target.checked}),className:"w-5 h-5 text-brand-600 rounded focus:ring-brand-500 border-gray-300"}),e.jsx("label",{htmlFor:"is_published",className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Publish immediately"})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:j,className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:w,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-bold text-white bg-brand-600 rounded-lg hover:bg-brand-700 transition-colors disabled:opacity-70",children:[w&&e.jsx(_,{className:"w-4 h-4 animate-spin"}),y?"Update Policy":"Create Policy"]})]})]})]})})]})};export{pe as default};
