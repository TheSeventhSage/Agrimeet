import{s as D,r as l,j as e,d as g,e as f}from"./index-BrJE6Ruv.js";import{a as O,P as F}from"./DashboardLayout-CbQpQ2VH.js";import{L as S}from"./loader-circle-mZ3-xmP4.js";import{F as L}from"./file-text-DhmWdPlz.js";import{C as U}from"./circle-check-big-CzdoeDj5.js";import{C as I}from"./star-D0UWI2kz.js";import{C as M}from"./calendar-BwB5JQaw.js";import{P as B}from"./pen-B4pCQIeY.js";import{T as R}from"./trash-2-DWTUZwMs.js";import{C as q}from"./chevron-left-DyrGgcS9.js";import{C as G}from"./x-89xIXrzd.js";import{C as V}from"./circle-x-uQfptDzR.js";import"./Logo-yv9J0Zw_.js";import"./house-B5NBqIRK.js";import"./createLucideIcon-DTbf89oH.js";import"./users-Btkg261Z.js";import"./file-check-BlT-5aXD.js";import"./circle-question-mark-DdVU0ul4.js";import"./message-circle-CfRGLCSX.js";import"./info-D8IKXDkN.js";import"./user-BoLJHLaW.js";import"./BackgroundArt-Cv4ql44m.js";const c="https://agrimeet.udehcoglobalfoodsltd.com/api/v1",z=()=>D.getAccessToken()||"",d=(t=!0)=>{const r={Authorization:`Bearer ${z()}`,Accept:"application/json"};return t&&(r["Content-Type"]="application/json"),r},m=async t=>{if(!t.ok){let r;try{r=await t.json()}catch{r={message:"An unknown error occurred."}}const n=new Error(r.message||`Error ${t.status}`);throw n.status=t.status,n.data=r,n}return t.status===204?null:t.json()},J=(t={})=>{const r=Object.fromEntries(Object.entries(t).filter(([u,a])=>a!=null&&a!=="")),n=new URLSearchParams(r).toString();return n?`?${n}`:""},h={async getAll(t={}){const r=J(t),n=await fetch(`${c}/admin/terms-of-services${r}`,{method:"GET",headers:d()});return m(n)},async getById(t){const r=await fetch(`${c}/admin/terms-of-services/${t}`,{method:"GET",headers:d()});return m(r)},async create(t){const r=await fetch(`${c}/admin/terms-of-services`,{method:"POST",headers:d(),body:JSON.stringify(t)});return m(r)},async update(t,r){const n=await fetch(`${c}/admin/terms-of-services/${t}`,{method:"PUT",headers:d(),body:JSON.stringify(r)});return m(n)},async delete(t){const r=await fetch(`${c}/admin/terms-of-services/${t}`,{method:"DELETE",headers:d()});return m(r)},async publish(t){const r=await fetch(`${c}/admin/terms-of-services/${t}/publish`,{method:"POST",headers:d()});return m(r)},async unpublish(t){const r=await fetch(`${c}/admin/terms-of-services/${t}/unpublish`,{method:"POST",headers:d()});return m(r)}},pe=()=>{const[t,r]=l.useState([]),[n,u]=l.useState(!0),[a,k]=l.useState({current_page:1,last_page:1,total:0}),[T,w]=l.useState(!1),[N,v]=l.useState(!1),[b,y]=l.useState(null),[o,x]=l.useState({content:"",is_published:!1}),p=async(s=1)=>{try{u(!0);const i=await h.getAll({page:s});r(i.data||[]),k({current_page:i.current_page||1,last_page:i.last_page||1,total:i.total||0})}catch(i){console.error("Failed to fetch terms:",i),g("Failed to load terms of service")}finally{u(!1)}};l.useEffect(()=>{p()},[]);const C=(s=null)=>{s?(y(s.id),x({content:s.content,is_published:!!s.is_published})):(y(null),x({content:"",is_published:!1})),w(!0)},j=()=>{w(!1),y(null),x({content:"",is_published:!1})},E=async s=>{if(s.preventDefault(),!o.content.trim()){g("Content is required");return}try{v(!0),b?(await h.update(b,o),f("Terms of service updated successfully")):(await h.create(o),f("Terms of service created successfully")),j(),p(a.current_page)}catch(i){g(i.message||"Operation failed")}finally{v(!1)}},P=async s=>{if(window.confirm("Are you sure you want to delete this version?"))try{u(!0),await h.delete(s),f("Terms of service deleted successfully"),p(a.current_page)}catch(i){g(i.message||"Failed to delete"),u(!1)}},$=async s=>{try{s.is_published?(await h.unpublish(s.id),f("Unpublished successfully")):(await h.publish(s.id),f("Published successfully")),p(a.current_page)}catch(i){g(i.message||"Failed to update status")}},_=s=>{s>=1&&s<=a.last_page&&p(s)},A=s=>s?new Date(s).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"}):"N/A";return e.jsxs(O,{children:[e.jsxs("div",{className:"p-2 lg:p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Terms of Service"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Manage legal terms and conditions versions"})]}),e.jsxs("button",{onClick:()=>C(),className:"flex items-center justify-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsx("span",{children:"Add New Version"})]})]}),e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:n?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(S,{className:"w-8 h-8 text-brand-600 animate-spin"})}):t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(L,{className:"w-6 h-6 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No versions found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Get started by creating a new terms of service version."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600",children:"ID"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600 w-1/2",children:"Content Preview"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600",children:"Status"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600",children:"Created At"}),e.jsx("th",{className:"md:px-6 md:py-4 px-4 py-3 font-medium text-gray-600 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsxs("td",{className:"md:px-6 md:py-4 px-4 py-3 text-gray-900 font-medium",children:["#",s.id]}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-gray-600 max-w-sm",children:e.jsx("div",{className:"line-clamp-1 max-w-[100%]",children:s.content})}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3",children:e.jsxs("button",{onClick:()=>$(s),className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full text-xs font-medium border cursor-pointer transition-all ${s.is_published?"bg-green-50 text-green-700 border-green-200 hover:bg-green-100":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,title:s.is_published?"Click to Unpublish":"Click to Publish",children:[s.is_published?e.jsx(U,{className:"w-3.5 h-3.5"}):e.jsx(I,{className:"w-3.5 h-3.5"}),s.is_published?"Published":"Draft"]})}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 text-gray-400"}),A(s.created_at)]})}),e.jsx("td",{className:"md:px-6 md:py-4 px-4 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>C(s),className:"p-2 text-gray-800 hover:text-brand-700 hover:bg-brand-300 rounded-lg transition-colors",title:"Edit",children:e.jsx(B,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>P(s.id),className:"p-2 text-gray-800 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(R,{className:"w-4 h-4"})})]})})]},s.id))})]})}),a.last_page>1&&e.jsxs("div",{className:"md:px-6 md:py-4 px-4 py-3 border-t border-gray-100 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Page ",a.current_page," of ",a.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>_(a.current_page-1),disabled:a.current_page<=1,className:"p-2 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>_(a.current_page+1),disabled:a.current_page>=a.last_page,className:"p-2 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(G,{className:"w-4 h-4"})})]})]})]})})]}),T&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:b?"Edit Terms of Service":"Create New Version"}),e.jsx("button",{onClick:j,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(V,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:E,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Content"}),e.jsx("textarea",{required:!0,rows:12,className:"w-full rounded-lg border-gray-300 shadow-sm focus:border-brand-500 focus:ring-brand-500 text-sm font-mono bg-gray-50 p-4",placeholder:"Enter terms of service content here...",value:o.content,onChange:s=>x({...o,content:s.target.value})}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Supports plain text. Formatting will be preserved as entered."})]}),e.jsxs("div",{className:"flex items-center gap-3 py-2",children:[e.jsx("input",{type:"checkbox",id:"is_published",className:"rounded border-gray-300 text-brand-600 focus:ring-brand-500 h-4 w-4",checked:o.is_published,onChange:s=>x({...o,is_published:s.target.checked})}),e.jsxs("label",{htmlFor:"is_published",className:"text-sm text-gray-700 select-none cursor-pointer",children:["Publish immediately ",e.jsx("i",{className:"text-brand-700",children:"(Uncheck to unpiblish)"})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-gray-100 mt-4",children:[e.jsx("button",{type:"button",onClick:j,className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",disabled:N,className:"flex items-center gap-2 px-5 py-2.5 text-sm font-bold text-white bg-brand-600 rounded-lg hover:bg-brand-700 transition-colors disabled:opacity-70",children:[N&&e.jsx(S,{className:"w-4 h-4 animate-spin"}),b?"Update Version":"Create Version"]})]})]})]})})]})};export{pe as default};
