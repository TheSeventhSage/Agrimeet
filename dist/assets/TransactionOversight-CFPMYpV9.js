import{D as j,r as n,d as u,j as e,e as v}from"./index-BOLkSH9S.js";import{D as E,E as O}from"./DashboardLayout-BvCakflT.js";import{C as T}from"./ConfirmationModal-cvEjaG2Q.js";import{F as q}from"./funnel-BAYOSG7h.js";import{C as L}from"./clock-ClWTmPxa.js";import{C as z}from"./chevron-left-B0iQB9Pm.js";import{C as P}from"./package-CKJSu7qp.js";import{X as I}from"./x-C2LEswAj.js";import{C as M}from"./star-C1ESBnNj.js";import{U}from"./user-CozA4sKy.js";import{S as $}from"./store-DAu4H_1r.js";import{C as G}from"./circle-x-Bxs6Jh5B.js";import{C as X}from"./circle-check-big-DahogGvV.js";import"./Logo-g0xKsfJ_.js";import"./house-CbQ0kLy2.js";import"./createLucideIcon-Df3o3GTg.js";import"./users-B4SWA-Gw.js";import"./file-check-CwXOnyIx.js";import"./shield-check-BosUqYmL.js";import"./circle-question-mark-CVrBAAd0.js";import"./message-circle-BHYE61eq.js";import"./file-text-CticlOFV.js";import"./BackgroundArt-ChQV54k0.js";const B=async(l={})=>{try{return await j.get("/admin/withdrawals",{params:l})}catch(r){throw console.error("Error fetching withdrawals:",r),r}},H=async l=>{try{return await j.post(`/admin/withdrawl/${l}/approve`)}catch(r){throw console.error("Error approving withdrawal:",r),r}},J=async l=>{try{return await j.post(`/admin/withdrawl/${l}/reject`)}catch(r){throw console.error("Error rejecting withdrawal:",r),r}},y={getWithdrawals:B,approveWithdrawal:H,rejectWithdrawal:J},je=()=>{const[l,r]=n.useState([]),[f,b]=n.useState(!0),[m,x]=n.useState(!1),[a,C]=n.useState(null),[S,o]=n.useState(!1),[d,c]=n.useState({isOpen:!1,title:"",message:"",type:"info",onConfirm:()=>{}}),[p,h]=n.useState({status:"",page:1}),[i,_]=n.useState({current_page:1,last_page:1,total:0,per_page:20});n.useEffect(()=>{g()},[p]);const g=async()=>{try{b(!0);const s=await y.getWithdrawals(p),t=s.data?.data?s.data:s;r(t.data||[]),t.meta&&_({current_page:t.meta.current_page,last_page:t.meta.last_page,total:t.meta.total,per_page:t.meta.per_page})}catch(s){console.error("Error loading withdrawals:",s),u("Failed to load withdrawal requests")}finally{b(!1)}},A=s=>{c({isOpen:!0,title:"Approve Request",message:"Are you sure you want to approve this withdrawal? Funds will be released to the seller immediately.",type:"success",onConfirm:()=>k(s)})},R=s=>{c({isOpen:!0,title:"Reject Request",message:"Are you sure you want to reject this withdrawal? The funds will be reversed to the seller wallet.",type:"danger",onConfirm:()=>F(s)})},k=async s=>{try{x(!0),await y.approveWithdrawal(s),v("Withdrawal request approved successfully"),o(!1),g()}catch(t){u(t.response?.data?.message||"Failed to approve withdrawal")}finally{x(!1),c(t=>({...t,isOpen:!1}))}},F=async s=>{try{x(!0),await y.rejectWithdrawal(s),v("Withdrawal request rejected"),o(!1),g()}catch(t){u(t.response?.data?.message||"Failed to reject withdrawal")}finally{x(!1),c(t=>({...t,isOpen:!1}))}},w=s=>{s>=1&&s<=i.last_page&&h(t=>({...t,page:s}))},W=(s,t)=>{h(D=>({...D,[s]:t,page:1}))},N=s=>{switch(s){case"completed":return"bg-green-100 text-green-700";case"pending":return"bg-yellow-100 text-yellow-700";case"processing":return"bg-blue-100 text-blue-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs(E,{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Withdrawal Requests"}),e.jsx("p",{className:"text-gray-600",children:"Manage and oversee seller payouts"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-[200px]",children:[e.jsx(q,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:p.status,onChange:s=>W("status",s.target.value),className:"w-full border-gray-300 rounded-lg focus:ring-brand-500 focus:border-brand-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsx("button",{onClick:()=>h({status:"",page:1}),className:"text-sm text-gray-500 hover:text-brand-600 font-medium ml-auto",children:"Clear Filters"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Seller"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Gateway / Ref"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:f?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600"})})})}):l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No withdrawal requests found."})}):l.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-100 flex items-center justify-center text-brand-700 font-medium text-sm",children:s.user?.first_name?.charAt(0)||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.user?.first_name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.user?.seller?.store_name||"N/A"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["₦",parseFloat(s.amount).toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${N(s.status)}`,children:s.status})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:s.gateway||"-"}),e.jsx("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",title:s.reference,children:s.reference||"-"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:new Date(s.created_at).toLocaleDateString()})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>{C(s),o(!0)},className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500 transition-colors",children:e.jsx(O,{className:"w-5 h-5"})})})]},s.id))})]})}),!f&&l.length>0&&e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Showing page ",i.current_page," of ",i.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(i.current_page-1),disabled:i.current_page===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>w(i.current_page+1),disabled:i.current_page===i.last_page,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(P,{className:"w-4 h-4"})})]})]})]}),S&&a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Withdrawal Details"}),e.jsx("button",{onClick:()=>o(!1),className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:e.jsx(I,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-lg border ${N(a.status)} bg-opacity-10 border-opacity-20`,children:[e.jsx(M,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold capitalize",children:["Status: ",a.status]}),e.jsx("p",{className:"text-xs opacity-90",children:a.note||"No additional notes"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Transaction Info"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Amount"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["₦",parseFloat(a.amount).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Date"}),e.jsx("span",{className:"text-gray-900",children:new Date(a.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Gateway"}),e.jsx("span",{className:"text-gray-900 capitalize",children:a.gateway||"N/A"})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Reference"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs",children:a.reference||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Seller Info"}),e.jsxs("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(U,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900 font-medium",children:a.user?.name})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx($,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:a.user?.seller?.store_name})]}),e.jsx("div",{className:"text-xs text-gray-500 pl-7",children:a.user?.email}),e.jsx("div",{className:"text-xs text-gray-500 pl-7",children:a.user?.seller?.business_phone_number})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium",children:"Close"}),a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>R(a.id),disabled:m,className:"flex items-center gap-2 px-4 py-2 text-red-700 bg-white border border-red-200 rounded-lg hover:bg-red-50 font-medium disabled:opacity-50",children:[e.jsx(G,{className:"w-4 h-4"}),"Reject Request"]}),e.jsxs("button",{onClick:()=>A(a.id),disabled:m,className:"flex items-center gap-2 px-4 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700 font-medium shadow-sm disabled:opacity-50",children:[m?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(X,{className:"w-4 h-4"}),"Approve & Pay"]})]})]})]})}),e.jsx(T,{isOpen:d.isOpen,onClose:()=>c(s=>({...s,isOpen:!1})),onConfirm:d.onConfirm,title:d.title,message:d.message,type:d.type})]})};export{je as default};
