import{j as e,s as J,h as I,r as u}from"./index-BOLkSH9S.js";import{c as k}from"./createLucideIcon-Df3o3GTg.js";import{C as z}from"./star-C1ESBnNj.js";import{C as Y}from"./clock-ClWTmPxa.js";import{P as _,C as Q}from"./package-CKJSu7qp.js";import{C as W}from"./circle-check-big-DahogGvV.js";import{B as b}from"./Button-DPYyXRjf.js";import{S as X}from"./search-Ckn77Lrt.js";import{E as Z,D as U}from"./DashboardLayout-BvCakflT.js";import{C as K}from"./chevron-left-B0iQB9Pm.js";import{A as ee}from"./arrow-left-Cgff3Zyj.js";import{T as L}from"./truck-yp2CDNgS.js";import{B as se}from"./box-Cof5fENi.js";import{U as te}from"./user-CozA4sKy.js";import{P as re}from"./phone-DkC1kBQq.js";import{M as ae}from"./map-pin-BY2_uCYu.js";import{S as le}from"./shield-check-BosUqYmL.js";import{C as ne}from"./credit-card-ZC6Uwims.js";import{T as M}from"./trending-up-86NqQPl4.js";import{U as ie}from"./users-B4SWA-Gw.js";import{A as y}from"./arrow-up-right-o1Zno_gf.js";import{C as ce}from"./calendar-DsG1bE9y.js";import{F as oe}from"./file-text-CticlOFV.js";import{X as de}from"./x-C2LEswAj.js";import"./Logo-g0xKsfJ_.js";import"./house-CbQ0kLy2.js";import"./file-check-CwXOnyIx.js";import"./circle-question-mark-CVrBAAd0.js";import"./message-circle-BHYE61eq.js";import"./BackgroundArt-ChQV54k0.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],F=k("arrow-down-right",xe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],he=k("list",me);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],ge=k("printer",ue);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],be=k("receipt",pe),fe=({activeTab:s,onTabChange:r})=>{const a=[{id:"all",label:"All Orders",icon:he,color:"text-gray-600"},{id:"unpaid",label:"Unpaid",icon:z,color:"text-red-600"},{id:"unfulfilled",label:"Unfulfilled",icon:Y,color:"text-yellow-600"},{id:"open",label:"Open (Paid/Unfulfilled)",icon:_,color:"text-blue-600"},{id:"closed",label:"Closed (Completed)",icon:W,color:"text-green-600"}];return e.jsx("div",{className:"border-b border-gray-200 mb-6 overflow-x-auto",children:e.jsx("div",{className:"flex space-x-2 min-w-max pb-1",children:a.map(t=>{const l=t.icon,i=s===t.id;return e.jsxs("button",{onClick:()=>r(t.id),className:`flex items-center px-4 py-3 rounded-t-lg text-sm font-medium transition-all duration-200 whitespace-nowrap border-b-2 ${i?"border-brand-600 text-brand-600 bg-brand-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(l,{className:`w-4 h-4 mr-2 ${i?"text-brand-600":t.color}`}),e.jsx("span",{children:t.label})]},t.id)})})})},N="https://agrimeetbackend.agrimeetconnect.com/api/v1",f={paid:{label:"Paid",color:"bg-green-100 text-green-800 border-green-200"},unpaid:{label:"Unpaid",color:"bg-red-100 text-red-800 border-red-200"},fulfilled:{label:"Fulfilled",color:"bg-green-100 text-green-800 border-green-200"},unfulfilled:{label:"Unfulfilled",color:"bg-yellow-100 text-yellow-800 border-yellow-200"},pending:{label:"Pending",color:"bg-gray-100 text-gray-800 border-gray-200"},processing:{label:"Processing",color:"bg-blue-100 text-blue-800 border-blue-200"},processed:{label:"Processed",color:"bg-indigo-100 text-indigo-800 border-indigo-200"},delivered:{label:"Delivered",color:"bg-green-100 text-green-800 border-green-200"},cancelled:{label:"Cancelled",color:"bg-red-100 text-red-800 border-red-200"},intransit:{label:"In Transit",color:"bg-orange-100 text-orange-800 border-orange-200"}},v=()=>{try{return J.getAccessToken()}catch(s){return console.error("Error getting auth token:",s),null}},je=s=>{switch(s){case"unpaid":return{unpaid:"true"};case"unfulfilled":return{unfulfilled:"true"};case"open":return{open:"true"};case"closed":return{closed:"true"};case"all":default:return{}}},ye=s=>s?{id:s.id,orderNumber:s.order_number,paymentStatus:s.payment_status||"unpaid",orderStatus:s.order_status||"pending",fulfillmentStatus:s.fulfillment_status||"unfulfilled",orderDate:s.created_at,paidAt:s.paid_at,totalAmount:parseFloat(s.total_amount||0),shippingAmount:parseFloat(s.shipping_amount||0),sellerEarnings:parseFloat(s.total_seller_earnings||0),commission:parseFloat(s.total_commission||0),customer:{name:s.customer_fullname||"Guest Customer",phone:s.customer_phone||"N/A",address:s.customer_address,city:s.customer_city,state:s.customer_state,country:s.customer_country},trackingNumber:s.tracking_number,courierName:s.courier_name,items:Array.isArray(s.items)?s.items.map(r=>({id:r.id,name:r.name,quantity:r.quantity,price:parseFloat(r.unit_price||0),total:parseFloat(r.total_price||0),image:r.thumbnail,variant:r.variant_attributes})):[]}:null,j={async getOrders(s={}){try{const r=v();if(!r)throw new Error("Authentication token not found");const a=new URLSearchParams;if(s.status&&s.status!=="all"){const i=je(s.status);Object.entries(i).forEach(([h,c])=>{a.append(h,c)})}s.page&&a.append("page",s.page.toString());const t=await fetch(`${N}/seller/orders?${a.toString()}`,{method:"GET",headers:{Authorization:`Bearer ${r}`,Accept:"application/json","Content-Type":"application/json"}});if(!t.ok)throw t.status===401?new Error("Unauthorized"):new Error(`Failed to fetch orders: ${t.status}`);const l=await t.json();return{data:l.data.map(ye),meta:l.meta}}catch(r){throw console.error("Error fetching orders:",r),r}},async getOrderDetails(s){try{const r=v();if(!r)throw new Error("Authentication token not found");const a=await fetch(`${N}/seller/orders/${s}`,{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}});if(!a.ok)throw new Error("Failed to fetch order details");return(await a.json()).data}catch(r){throw console.error("Error fetching order details:",r),r}},async updateOrderStatus(s,r){try{const a=v(),t=await fetch(`${N}/seller/orders/${s}`,{method:"PUT",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(r)});if(!t.ok)throw new Error("Failed to update status");return await t.json()}catch(a){throw a}},async downloadInvoice(s){try{const r=v();if(!r)throw new Error("Authentication token not found");const a=await fetch(`${N}/seller/orders/${s}/invoice`,{method:"GET",headers:{Authorization:`Bearer ${r}`,Accept:"application/pdf"}});if(!a.ok){if(a.status===404)throw new Error("Invoice not found");if(a.status===401)throw new Error("Unauthorized");try{const t=await a.json();throw new Error(t.error||"Failed to generate invoice")}catch{throw new Error("Failed to generate invoice")}}return await a.blob()}catch(r){throw console.error("Error downloading invoice:",r),r}}},Ne=({orders:s,isLoading:r,onViewDetails:a,onPageChange:t,pagination:l})=>{const i=({type:c,status:n})=>{const d=f[n]||{label:n,color:"bg-gray-100 text-gray-800"};return e.jsxs("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium capitalize border ${d.color} mb-1 mr-1`,children:[e.jsxs("span",{className:"text-[10px] uppercase text-gray-400 mr-1 font-bold",children:[c,":"]}),d.label]})},h=()=>{const c=[],{current_page:n,last_page:d}=l;c.push(1),n>3&&c.push("...");for(let m=Math.max(2,n-1);m<=Math.min(d-1,n+1);m++)c.push(m);return n<d-2&&c.push("..."),d>1&&c.push(d),c};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(I,{size:"lg"})}):s.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-xl border border-gray-100",children:[e.jsx("div",{className:"mx-auto h-12 w-12 text-gray-400 bg-gray-50 rounded-full flex items-center justify-center mb-4",children:e.jsx(X,{className:"w-6 h-6"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No orders found"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"There are no orders in this category."})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Order Ref"}),e.jsx("th",{className:"px-6 py-4",children:"Date"}),e.jsx("th",{className:"px-6 py-4",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 w-1/3",children:"Status Overview"}),e.jsx("th",{className:"px-6 py-4",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:c.orderNumber}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:new Date(c.orderDate).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 text-gray-900",children:[e.jsx("div",{className:"font-medium",children:c.customer?.name}),e.jsx("div",{className:"text-xs text-gray-500",children:c.customer?.phone})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx(i,{type:"Pay",status:c.paymentStatus}),e.jsx(i,{type:"Ord",status:c.orderStatus}),e.jsx(i,{type:"Ful",status:c.fulfillmentStatus})]})}),e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900",children:["₦",c.totalAmount?.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(b,{variant:"ghost",size:"sm",onClick:()=>a(c.id),className:"text-brand-600 hover:text-brand-700",children:e.jsx(Z,{className:"w-4 h-4"})})})]},c.id))})]})}),l.last_page>1&&e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-gray-100 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-500 hidden sm:block",children:["Showing page ",e.jsx("span",{className:"font-medium",children:l.current_page})," of ",e.jsx("span",{className:"font-medium",children:l.last_page})]}),e.jsxs("div",{className:"flex items-center space-x-1 mx-auto sm:mx-0",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:()=>t(l.current_page-1),disabled:l.current_page<=1,className:"px-2",children:e.jsx(K,{className:"w-4 h-4"})}),h().map((c,n)=>c==="..."?e.jsx("span",{className:"px-2 text-gray-400",children:"..."},`dots-${n}`):e.jsx("button",{onClick:()=>t(c),className:`min-w-[32px] h-8 rounded-md text-sm font-medium transition-colors ${l.current_page===c?"bg-brand-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:c},c)),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>t(l.current_page+1),disabled:l.current_page>=l.last_page,className:"px-2",children:e.jsx(Q,{className:"w-4 h-4"})})]})]})]})})},w=(s,r="default")=>({paid:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",unfulfilled:"bg-orange-100 text-orange-800 border-orange-200",fulfilled:"bg-green-100 text-green-800 border-green-200",cancelled:"bg-red-100 text-red-800 border-red-200",open:"bg-blue-100 text-blue-800 border-blue-200"})[s?.toLowerCase()]||"bg-gray-100 text-gray-800 border-gray-200",ve=({order:s,onBack:r,onPrintInvoice:a})=>{if(!s)return null;console.log(s);const t=i=>`₦${Number(i||0).toLocaleString(void 0,{minimumFractionDigits:2})}`,l=i=>i?new Date(i).toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A";return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 pb-10",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{variant:"outline",size:"sm",onClick:r,className:"h-10 w-10 p-0 rounded-full",children:e.jsx(ee,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:s.order_number}),s.read&&e.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-100 text-gray-500 border border-gray-200",children:"Read"})]}),e.jsxs("p",{className:"text-gray-500 text-sm mt-1",children:["Placed on ",l(s.created_at)]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{variant:"outline",onClick:()=>a(s),children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),"Print Invoice"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Payment Status"}),e.jsx("div",{className:`mt-2 inline-flex px-2.5 py-1 rounded-md text-sm font-medium border ${w(s.payment_status)}`,children:s.payment_status})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-400",children:"Paid At"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:l(s.paid_at)})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Fulfillment"}),e.jsx("div",{className:`mt-2 inline-flex px-2.5 py-1 rounded-md text-sm font-medium border ${w(s.fulfillment_status)}`,children:s.fulfillment_status})]}),e.jsx(L,{className:"w-8 h-8 text-gray-200"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-semibold",children:"Order State"}),e.jsx("div",{className:`mt-2 inline-flex px-2.5 py-1 rounded-md text-sm font-medium border ${w(s.order_status)}`,children:s.order_status})]}),e.jsx(_,{className:"w-8 h-8 text-gray-200"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-100 bg-gray-50/50 flex justify-between items-center",children:e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-gray-500"}),"Order Items (",s.items.length,")"]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:s.items.map(i=>e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"h-20 w-20 rounded-lg bg-gray-100 flex-shrink-0 overflow-hidden border border-gray-200",children:e.jsx("img",{src:i.thumbnail,alt:i.name,className:"h-full w-full object-cover",onError:h=>{h.target.src="https://placehold.co/100x100?text=No+Img"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:i.name}),i.variant_attributes&&i.variant_attributes.length>0&&e.jsx("div",{className:"flex gap-1 mt-1",children:i.variant_attributes.map((h,c)=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-1.5 py-0.5 rounded",children:h},c))}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`text-[10px] uppercase font-bold tracking-wide px-1.5 py-0.5 rounded border ${w(i.fulfillment_status)}`,children:i.fulfillment_status})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-gray-900",children:t(i.total_price)}),e.jsxs("p",{className:"text-sm text-gray-500",children:[i.quantity," x ",t(i.unit_price)]})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-50 flex gap-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{children:"Platform Fee:"}),e.jsxs("span",{className:"text-red-600 font-medium",children:["-",t(i.platform_commission_amount)]}),e.jsxs("span",{className:"text-gray-400",children:["(",Number(i.platform_commission_rate),"%)"]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{children:"Your Earnings:"}),e.jsx("span",{className:"text-green-600 font-bold",children:t(i.seller_earnings)})]})]})]})]})},i.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(be,{className:"w-4 h-4 text-gray-500"}),"Financial Breakdown"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Customer Paid"}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Items Total"}),e.jsx("span",{children:t(Number(s.total_amount)-Number(s.shipping_amount)+Number(s.shipping_discount))})]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Shipping Cost"}),e.jsx("span",{children:t(s.shipping_amount)})]}),Number(s.shipping_discount)>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Shipping Discount"}),e.jsxs("span",{children:["-",t(s.shipping_discount)]})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total Order Value"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:t(s.total_amount)})]})]}),e.jsxs("div",{className:"space-y-3 md:border-l md:pl-8 border-gray-100",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Seller Net (You)"}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Total Commission Deducted"}),e.jsxs("span",{className:"text-red-500",children:["-",t(s.total_commission)]})]}),e.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"Shipping Revenue"}),e.jsx("span",{children:t(Number(s.shipping_amount)-Number(s.shipping_discount))})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-100 flex justify-between items-center bg-green-50 -mx-4 px-4 py-2 rounded-lg mt-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-green-900",children:"Total Earnings"}),e.jsx("span",{className:"text-xs text-green-700",children:"Sent to Wallet"})]}),e.jsx("span",{className:"text-xl font-bold text-green-700",children:t(s.total_seller_earnings)})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-gray-500"}),"Customer Details"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-brand-100 flex items-center justify-center text-brand-700 font-bold border border-brand-200",children:s.customer_fullname?.charAt(0)||"G"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:s.customer_fullname||"Guest"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",s.user_id]})]})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-100 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(re,{className:"w-4 h-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Phone Number"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.customer_phone||"N/A"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Delivery Address"}),e.jsxs("p",{className:"text-sm text-gray-700 mt-1",children:[s.customer_address,e.jsx("br",{}),s.customer_address_2&&e.jsxs("span",{children:[s.customer_address_2,e.jsx("br",{})]}),s.customer_city,", ",s.customer_state,e.jsx("br",{}),s.customer_country]}),s.customer_default_delivery_address&&e.jsxs("span",{className:"mt-2 inline-flex items-center gap-1 text-[10px] bg-gray-100 px-2 py-0.5 rounded text-gray-600",children:[e.jsx(le,{className:"w-3 h-3"})," Default Address"]})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-6",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-4 h-4 text-gray-500"}),"Logistics Information"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-bold",children:"Courier Service"}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.courier_name||"N/A"}),e.jsx("span",{className:"text-xs text-gray-400 font-mono",children:s.courier_code})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-50",children:[e.jsx("label",{className:"text-xs text-gray-500 uppercase font-bold",children:"Tracking Number"}),e.jsx("div",{className:"mt-1",children:s.tracking_number?e.jsx("span",{className:"font-mono bg-blue-50 text-blue-700 px-2 py-1 rounded text-sm border border-blue-100 block text-center",children:s.tracking_number}):e.jsx("span",{className:"text-sm text-gray-400 italic",children:"Not generated yet"})})]}),s.shipping_request_token&&e.jsxs("div",{className:"pt-2 border-t border-gray-50",children:[e.jsx("label",{className:"text-[10px] text-gray-400 uppercase",children:"Request Token"}),e.jsx("p",{className:"text-[10px] text-gray-300 font-mono break-all leading-tight mt-1",children:s.shipping_request_token})]})]})]})]})]})]})},we=({orderStats:s,isLoading:r})=>{if(r||!s)return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map((n,d)=>e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded-sm w-3/4 mb-3"}),e.jsx("div",{className:"h-8 bg-gray-200 rounded-sm w-1/2 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded-sm w-1/4"})]},d))});const a=n=>`₦${n.toLocaleString()}`,t=(n,d)=>d?((n-d)/d*100).toFixed(1):0,l={total:45,pending:8,processing:12,shipped:15,delivered:28,totalRevenue:85e4},i=[{title:"Total Orders",value:s.total,previousValue:l.total,icon:_,color:"blue"},{title:"Total Revenue",value:a(s.totalRevenue),rawValue:s.totalRevenue,previousValue:l.totalRevenue,icon:ne,color:"green"},{title:"Average Order Value",value:a(Math.round(s.totalRevenue/s.total||0)),rawValue:s.totalRevenue/s.total,previousValue:l.totalRevenue/l.total,icon:M,color:"purple"},{title:"Completed Orders",value:s.delivered,previousValue:l.delivered,icon:ie,color:"emerald"}],h=[{status:"pending",label:"Pending",value:s.pending,previousValue:l.pending,config:f.pending},{status:"processing",label:"Processing",value:s.processing,previousValue:l.processing,config:f.processing},{status:"shipped",label:"Shipped",value:s.shipped,previousValue:l.shipped,config:f.shipped},{status:"delivered",label:"Delivered",value:s.delivered,previousValue:l.delivered,config:f.delivered}],c={blue:"bg-blue-50 border-blue-200 text-blue-600",green:"bg-green-50 border-green-200 text-green-600",purple:"bg-purple-50 border-purple-200 text-purple-600",emerald:"bg-emerald-50 border-emerald-200 text-emerald-600"};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Overview"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:i.map(n=>{const d=n.icon,m=t(n.rawValue||n.value,n.previousValue),p=parseFloat(m)>=0;return e.jsxs("div",{className:`border rounded-xl p-6 ${c[n.color]}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium opacity-80 mb-1",children:n.title}),e.jsx("h4",{className:"text-2xl font-bold",children:n.value})]}),e.jsx(d,{className:"w-8 h-8 opacity-80"})]}),e.jsxs("div",{className:"flex items-center text-sm",children:[p?e.jsx(y,{className:"w-4 h-4 text-green-600 mr-1"}):e.jsx(F,{className:"w-4 h-4 text-red-600 mr-1"}),e.jsxs("span",{className:`font-medium ${p?"text-green-600":"text-red-600"}`,children:[Math.abs(m),"%"]}),e.jsx("span",{className:"text-gray-600 ml-1",children:"vs last period"})]})]},n.title)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Order Status Breakdown"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map(n=>{const d=t(n.value,n.previousValue),m=parseFloat(d)>=0,p=(n.value/s.total*100).toFixed(1);return e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full mr-2 ${n.config.badgeColor}`}),e.jsx("p",{className:"text-sm font-medium text-gray-700",children:n.label})]}),e.jsx("h4",{className:"text-3xl font-bold text-gray-900",children:n.value})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[p,"% of total"]}),e.jsxs("div",{className:"flex items-center",children:[m?e.jsx(y,{className:"w-3 h-3 text-green-600 mr-1"}):e.jsx(F,{className:"w-3 h-3 text-red-600 mr-1"}),e.jsxs("span",{className:`text-xs font-medium ${m?"text-green-600":"text-red-600"}`,children:[Math.abs(d),"%"]})]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${n.config.badgeColor}`,style:{width:`${p}%`}})})]})]},n.status)})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Performance Metrics"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Fulfillment Rate"}),e.jsx(_,{className:"w-5 h-5 text-green-600"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:[(s.delivered/(s.total-s.cancelled)*100||0).toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center text-sm text-green-600 mb-1",children:[e.jsx(y,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:"+5.2%"})]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.delivered," of ",s.total-s.cancelled," orders delivered"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full",style:{width:`${s.delivered/(s.total-s.cancelled)*100||0}%`}})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Cancellation Rate"}),e.jsx(ce,{className:"w-5 h-5 text-red-600"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:[(s.cancelled/s.total*100||0).toFixed(1),"%"]}),e.jsxs("div",{className:"flex items-center text-sm text-green-600 mb-1",children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:"-2.1%"})]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[s.cancelled," of ",s.total," orders cancelled"]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-500 h-2 rounded-full",style:{width:`${s.cancelled/s.total*100||0}%`}})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Revenue Growth"}),e.jsx(M,{className:"w-5 h-5 text-blue-600"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-end space-x-2",children:[e.jsxs("span",{className:"text-3xl font-bold text-gray-900",children:[t(s.totalRevenue,l.totalRevenue),"%"]}),e.jsxs("div",{className:"flex items-center text-sm text-blue-600 mb-1",children:[e.jsx(y,{className:"w-3 h-3 mr-1"}),e.jsx("span",{children:"Growth"})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"vs previous period"}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Current: ",a(s.totalRevenue),e.jsx("br",{}),"Previous: ",a(l.totalRevenue)]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Quick Insights"}),e.jsx("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-1",children:s.processing+s.shipped}),e.jsx("div",{className:"text-sm text-blue-700",children:"Orders in Transit"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 mb-1",children:a(Math.round(s.totalRevenue/30))}),e.jsx("div",{className:"text-sm text-green-700",children:"Daily Average Revenue"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600 mb-1",children:(s.total/30).toFixed(1)}),e.jsx("div",{className:"text-sm text-purple-700",children:"Daily Average Orders"})]})]})})]})]})},S=({isOpen:s,onClose:r,order:a})=>{const[t,l]=u.useState(null),[i,h]=u.useState(!1),[c,n]=u.useState(null);u.useEffect(()=>(s&&a&&d(),()=>{t&&URL.revokeObjectURL(t)}),[s,a]);const d=async()=>{h(!0),n(null),t&&URL.revokeObjectURL(t),l(null);try{const m=await j.downloadInvoice(a.id),p=URL.createObjectURL(m);l(p)}catch(m){console.error(m),n(m.message||"Failed to load invoice.")}finally{h(!1)}};return s?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto margin ml-0 lg:ml-64",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-sidebar-200/40 backdrop-blur-sm",onClick:r}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl w-full h-[85vh] flex flex-col",children:[e.jsxs("div",{className:"bg-white px-4 py-3 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-gray-500"}),"Invoice: ",a?.orderNumber||a?.order_number||a?.id]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-gray-500",children:e.jsx(de,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 bg-gray-50 relative",children:i?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx(I,{size:"lg"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Generating Invoice PDF..."})]}):c?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center px-4",children:[e.jsx(z,{className:"h-10 w-10 text-red-500 mb-2"}),e.jsx("p",{className:"text-gray-900 font-medium mb-1",children:"Unavailable"}),e.jsx("p",{className:"text-gray-500 text-sm mb-4 text-center",children:c}),e.jsx(b,{onClick:d,variant:"outline",size:"sm",children:"Retry"})]}):t?e.jsx("iframe",{src:t,className:"w-full h-screen",title:"Invoice PDF"}):null})]})]})}):null},es=()=>{const[s,r]=u.useState("all"),[a,t]=u.useState([]),[l,i]=u.useState(null),[h,c]=u.useState(null),[n,d]=u.useState(!0),[m,p]=u.useState({}),[R,C]=u.useState(!1),[$,V]=u.useState(null),[A,P]=u.useState({current_page:1,last_page:1,per_page:20,total:0});u.useEffect(()=>{B()},[s,m,A.current_page]);const B=async()=>{try{d(!0);const x={...m,status:s==="all"?"":s,page:A.current_page},o=await j.getOrders(x);t(o.data||[]),c(o.stats||{}),o.meta&&P({current_page:o.meta.current_page,last_page:o.meta.last_page,per_page:o.meta.per_page,total:o.meta.total})}catch(x){console.error("Error fetching orders:",x)}finally{d(!1)}},O=async x=>{try{d(!0);const o=await j.getOrderDetails(x);i(o)}catch(o){console.error("Error fetching order details:",o)}finally{d(!1)}},T=async(x,o)=>{try{await j.updateOrderStatus(x,{status:o}),t(g=>g.map(E=>E.id===x?{...E,status:o}:E)),l&&l.id===x&&i(g=>({...g,status:o}))}catch(g){console.error("Error updating order status:",g)}},D=async x=>{if(!x){console.error("Invalid argument passed to handlePrintInvoice"),showError("Unable to generate invoice: Missing order information.");return}try{d(!0);let o=null;if(typeof x=="object"&&x!==null){if(!x.id)throw new Error("Invalid order data structure.");o=x}else if(typeof x=="number"||typeof x=="string")try{o=await j.getOrderDetails(x)}catch{throw new Error("Failed to retrieve fresh order details from server.")}else throw new Error("Invalid order identifier format.");if(!o)throw new Error("Order data is missing or could not be loaded.");V(o),C(!0)}catch(o){console.error("Invoice Generation Error:",o);let g="Failed to load invoice.";o.message.includes("Network")?g="Network error. Please check your internet connection.":o.message.includes("404")||o.message.includes("not found")?g="Order details could not be found.":o.message&&(g=o.message),showError(g)}finally{d(!1)}},G=x=>{p(x),P(o=>({...o,current_page:1}))},q=x=>{P(o=>({...o,current_page:x}))},H=()=>{i(null)};return l?e.jsx(U,{children:e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsx(ve,{order:l,onBack:H,onUpdateStatus:T,onPrintInvoice:D,isLoading:n}),e.jsx(S,{isOpen:R,onClose:()=>C(!1),order:$})]})}):e.jsx(U,{children:e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Orders Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage and track your customer orders"})]}),e.jsx(fe,{activeTab:s,onTabChange:r,orderStats:h||{}}),s==="analytics"?e.jsx(we,{orderStats:h,isLoading:!h}):e.jsx(Ne,{orders:a,isLoading:n,onViewDetails:O,onUpdateStatus:T,onPrintInvoice:D,onApplyFilters:G,onPageChange:q,pagination:A,currentFilters:m}),e.jsx(S,{isOpen:R,onClose:()=>C(!1),order:$})]})})};export{es as default};
