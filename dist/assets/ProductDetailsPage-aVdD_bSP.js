import{a as D,b as T,c as B,r as n,s as R,j as e,L as h,d as C,e as $}from"./index-C7G52Pl0.js";import{N as q,a as y}from"./Navbar-1mEq2cdd.js";import{L as U}from"./Logo-DmsMbJO2.js";import{B as b}from"./Button-rTuh0BPh.js";import{M as O,C as S,S as A}from"./star-C80gymXW.js";import{F as z,T as H,I as Y,L as G}from"./twitter-BLgeYviX.js";import{M as W}from"./mail-NbWfCbZg.js";import{P as Q}from"./phone-DsT_xwi1.js";import{M as V}from"./map-pin-DB9Cjm-f.js";import{L as J}from"./loader-circle-Cvar0TnB.js";import{C as P,P as K}from"./package-DupdcTls.js";import{C as X}from"./circle-check-big-28D-GMzn.js";import{T as Z}from"./tag-D2_pgiww.js";import{S as ee}from"./store-D_0Z2vXB.js";import"./search-Rqr5aH3r.js";import"./createLucideIcon-BK9ndVRo.js";import"./user-CwMqLLM3.js";import"./x-B7cmv6PP.js";import"./download-DfCU7q1a.js";const se=()=>e.jsx("div",{className:"flex justify-center items-center min-h-[60vh]",children:e.jsx(J,{className:"w-12 h-12 text-green-600 animate-spin"})}),te=({message:s})=>e.jsxs("div",{className:"flex flex-col justify-center items-center min-h-[60vh] text-center",children:[e.jsx(S,{className:"w-12 h-12 text-red-500 mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-800 mb-2",children:s==="Product not found"?"404 - Not Found":"An Error Occurred"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s==="Product not found"?"We couldn't find the product you're looking for.":s}),e.jsx(h,{to:"/",children:e.jsx(b,{children:"Go Back Home"})})]}),k=({rating:s,size:o="sm"})=>{const l=Array.from({length:5},(i,r)=>r<Math.round(s)),t=o==="sm"?"w-4 h-4":"w-5 h-5";return e.jsx("div",{className:"flex items-center gap-0.5",children:l.map((i,r)=>e.jsx(A,{className:`${i?"text-yellow-400":"text-gray-300"} ${t} fill-current`},r))})},ae=({product:s})=>e.jsx("nav",{className:"flex items-center text-sm text-gray-500 mb-4","aria-label":"Breadcrumb",children:e.jsxs("ol",{className:"flex items-center space-x-2",children:[e.jsx("li",{children:e.jsx(h,{to:"/",className:"hover:text-green-600",children:"Home"})}),e.jsx("li",{children:e.jsx(P,{className:"w-4 h-4 text-gray-400"})}),e.jsx("li",{children:e.jsx("span",{className:"hover:text-green-600 cursor-pointer",children:s.category||"Category"})}),e.jsx("li",{children:e.jsx(P,{className:"w-4 h-4 text-gray-400"})}),e.jsx("li",{className:"font-medium text-gray-700 truncate","aria-current":"page",children:s.name})]})}),re=({images:s=[],productName:o})=>{const[l,t]=n.useState(0),i=Array.isArray(s)?s:[],r=i[l]||"https://via.placeholder.com/600?text=No+Image";return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"aspect-square w-full bg-gray-100 rounded-lg overflow-hidden shadow-sm",children:e.jsx("img",{src:r,alt:`Main image of ${o}`,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-105"})}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:i.map((d,m)=>e.jsx("button",{onClick:()=>t(m),className:`aspect-square bg-gray-100 rounded-md overflow-hidden cursor-pointer border-2 transition-all ${m===l?"border-green-600 shadow-md":"border-transparent hover:border-gray-300"}`,children:e.jsx("img",{src:d,alt:`Thumbnail ${m+1} of ${o}`,className:"w-full h-full object-cover"})},m))})]})},le=({product:s,averageRating:o,totalReviews:l})=>{const t=Array.isArray(s.variants)?s.variants.reduce((d,m)=>d+(Number(m.stock_quantity)||0),0):0,i=t>0?t:s.stock_quantity||0,r=i>0;return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900",children:s.name}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(k,{rating:Number(o)||0,size:"md"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["(",l||0," reviews)"]})]}),e.jsxs("div",{className:"flex items-baseline gap-3",children:[e.jsxs("span",{className:"text-3xl font-bold text-green-600",children:["$",Number(s.discount_price||s.base_price).toFixed(2)]}),s.discount_price&&e.jsxs("span",{className:"text-xl text-gray-400 line-through",children:["$",Number(s.base_price).toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Stock:"}),r?e.jsxs("span",{className:"flex items-center gap-1.5 text-sm text-green-700 bg-green-100 px-2 py-0.5 rounded-full",children:[e.jsx(X,{className:"w-4 h-4"}),"In Stock (",i,")"]}):e.jsxs("span",{className:"flex items-center gap-1.5 text-sm text-red-700 bg-red-100 px-2 py-0.5 rounded-full",children:[e.jsx(S,{className:"w-4 h-4"}),"Out of Stock"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4 text-green-600"}),"Category: ",e.jsx("span",{className:"font-medium text-gray-800",children:s.category})]}),s.unit&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4 text-green-600"}),"Unit: ",e.jsxs("span",{className:"font-medium text-gray-800",children:[s.unit.name," (",s.unit.symbol,")"]})]}),e.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[e.jsx(ee,{className:"w-4 h-4 text-green-600"}),"Seller: ",e.jsx("span",{className:"font-medium text-gray-800",children:s.seller?.store_name||"AgriMeet Seller"})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(b,{size:"lg",className:"w-full md:w-auto",disabled:!r,children:r?"Add to Cart":"Out of Stock"})})]})},ie=({product:s,onSubmitSuccess:o})=>{const[l,t]=n.useState(0),[i,r]=n.useState(""),[d,m]=n.useState({}),[N,p]=n.useState(!1),j=()=>{const c={};return l===0&&(c.rating="Please select a rating."),i.trim().length<10&&(c.comment="Review must be at least 10 characters long."),m(c),Object.keys(c).length===0},g=async c=>{if(c.preventDefault(),!!j()){p(!0);try{const u={product_id:s.id,seller_id:s.seller.id,rating:l,review_comment:i,review_status:"pending"};await y.submitReview(u),$("Review submitted successfully! It will be visible after approval."),t(0),r(""),m({}),o()}catch(u){console.error("Failed to submit review:",u),C(u.data?.message||"Failed to submit review. Please try again.")}finally{p(!1)}}};return e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Write your review"}),e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Rating"}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(c=>e.jsx("button",{type:"button",onClick:()=>t(c),className:"focus:outline-none",children:e.jsx(A,{className:`w-6 h-6 cursor-pointer transition-colors ${c<=l?"text-yellow-400 fill-yellow-400":"text-gray-300 hover:text-yellow-400"}`})},c))}),d.rating&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.rating})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-medium text-gray-700",children:"Your Review"}),e.jsx("textarea",{id:"comment",name:"comment",rows:"4",value:i,onChange:c=>r(c.target.value),placeholder:"Share your thoughts on the product...",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500 sm:text-sm"}),d.comment&&e.jsx("p",{className:"text-xs text-red-600 mt-1",children:d.comment})]}),e.jsx("div",{className:"text-right",children:e.jsx(b,{type:"submit",loading:N,children:"Submit Review"})})]})]})},ce=({review:s,onLike:o,onUnlike:l})=>e.jsx("article",{className:"py-6 border-b border-gray-200 last:border-b-0",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("img",{src:s.user?.profile_photo||"https://static.vecteezy.com/system/resources/thumbnails/009/292/244/small/default-avatar-icon-of-social-media-user-vector.jpg",alt:s.user?.name||"Reviewer",className:"w-10 h-10 rounded-full bg-gray-200 object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900",children:s.user?.name||"Anonymous User"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx(k,{rating:s.rating})]}),e.jsx("p",{className:"text-sm text-gray-700 mt-3",children:s.review_comment}),s.review_reply&&e.jsxs("div",{className:"mt-4 ml-4 pl-4 border-l-2 border-green-200 bg-green-50/50 p-4 rounded-r-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-green-800",children:"Reply from seller"}),e.jsx("p",{className:"text-sm text-gray-700 mt-1",children:s.review_reply})]})]})]})});function Pe(){const{productId:s}=D(),o=T(),l=B(),[t,i]=n.useState(null),[r,d]=n.useState([]),[m,N]=n.useState(!0),[p,j]=n.useState(null),[g,c]=n.useState(null),[u,_]=n.useState([]);n.useEffect(()=>{const a=R.getUserData(),x=R.getTokens();if(a&&c(a),x){const w=x?.role?Array.isArray(x.role)?x.role:[x.role]:x?.roles?x.roles:[];_(w)}},[]);const F=async()=>{try{N(!0),j(null);const[a,x]=await Promise.all([y.getProduct(s),y.getProductReviews(s)]);i(a.data),d(x.data||[])}catch(a){console.error("Error loading product page:",a),a.status===404||a.message.includes("Product not found")?j("Product not found"):j(a.message||"Failed to load product details.")}finally{N(!1)}};n.useEffect(()=>{F()},[s]);const I=()=>g?!0:(C("Please log in to perform this action."),sessionStorage.setItem("redirectAfterLogin",l.pathname),o("/login",{state:{from:l.pathname}}),!1),L=()=>{y.getProductReviews(s).then(a=>{d(a.data||[])})},{averageRating:v,totalReviews:f}=n.useMemo(()=>!r||r.length===0?{averageRating:0,totalReviews:0}:{averageRating:(r.reduce((x,w)=>x+(Number(w.rating)||0),0)/r.length).toFixed(1),totalReviews:r.length},[r]),M=g&&u.includes("buyer"),E=g&&t&&g.seller?.id===t.seller.id;return m?e.jsx(se,{}):p?e.jsx(te,{message:p}):t?e.jsxs(e.Fragment,{children:[e.jsx(q,{}),e.jsx("main",{className:"bg-gray-50/50",children:e.jsxs("div",{className:"container mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(ae,{product:t}),e.jsx("section",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 md:p-8 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 items-center md:grid-cols-2 gap-8 md:gap-12",children:[e.jsx(re,{images:t.images,productName:t.name}),e.jsx(le,{product:t,averageRating:v,totalReviews:f})]})}),e.jsxs("section",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 md:p-8 mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"Product Description"}),e.jsx("div",{className:"prose prose-sm sm:prose-base max-w-none text-gray-700",dangerouslySetInnerHTML:{__html:t.description}}),t.variants&&t.variants.length>0&&e.jsxs("div",{className:"mt-8",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Available Variants"}),e.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Id"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sku"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.variants.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:a.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:a.sku}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:a.stock_quantity>0?e.jsxs("span",{className:"text-green-700",children:["In Stock (",a.stock_quantity,")"]}):e.jsx("span",{className:"text-red-700",children:"Out of Stock"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-800",children:["$",Number(a.price).toFixed(2)]})]},a.id))})]})})]})]}),e.jsxs("section",{className:"space-y-6",children:[e.jsxs("h2",{className:"text-2xl font-semibold text-gray-900",children:["Customer Reviews (",f,")"]}),f>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 flex items-center gap-4",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900",children:v}),e.jsxs("div",{className:"flex-1",children:[e.jsx(k,{rating:v,size:"md"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Based on ",f," reviews"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 bg-white rounded-lg shadow-sm border border-gray-200 p-6 md:p-8",children:f>0?e.jsx("div",{className:"divide-y divide-gray-200",children:r.map(a=>e.jsx(ce,{review:a},a.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(O,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"No reviews yet"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Be the first to review this product!"})]})}),e.jsx("div",{className:"lg:col-span-1",children:M?E?e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 text-center",children:[e.jsx(S,{className:"w-10 h-10 text-yellow-500 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"You cannot review your own product"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Reviews are for buyers purchasing from other sellers."})]}):e.jsx(ie,{product:t,onSubmitSuccess:L}):e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Want to share your thoughts?"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please log in as a buyer to write a review."}),e.jsx(b,{onClick:I,children:g?"Not a Buyer Account":"Login to Review"})]})})]})]})]})}),e.jsx("footer",{className:"bg-white border-t border-gray-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex  flex-col justify-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-linear-to-r from-green-600 to-green-700 rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(U,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold",children:"AgriMeet"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Farm Fresh Marketplace"})]})]}),e.jsx("p",{className:"text-sm text-gray-500 max-w-sm",children:"Connecting local farmers with customers who value sustainable, high-quality produce."}),e.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[e.jsx(h,{to:"#","aria-label":"Facebook",className:"p-1 rounded-lg hover:bg-gray-100",children:e.jsx(z,{className:"w-5 h-5 text-gray-600"})}),e.jsx(h,{to:"#","aria-label":"Twitter",className:"p-1 rounded-lg hover:bg-gray-100",children:e.jsx(H,{className:"w-5 h-5 text-gray-600"})}),e.jsx(h,{to:"#","aria-label":"Instagram",className:"p-1 rounded-lg hover:bg-gray-100",children:e.jsx(Y,{className:"w-5 h-5 text-gray-600"})}),e.jsx(h,{to:"#","aria-label":"LinkedIn",className:"p-1 rounded-lg hover:bg-gray-100",children:e.jsx(G,{className:"w-5 h-5 text-gray-600"})})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold mb-3",children:"Marketplace"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:e.jsx("a",{href:"#products",className:"hover:text-green-600",children:"Browse Products"})}),e.jsx("li",{children:e.jsx("button",{className:"hover:text-green-600",onClick:()=>performRedirect(ROUTES.REGISTER),children:"Become a Seller"})}),e.jsx("li",{children:e.jsx(h,{to:"/terms",className:"hover:text-green-600",children:"Terms & Conditions"})})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold mb-3",children:"Support"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("li",{children:e.jsx(h,{to:"/help-support",className:"hover:text-green-600",children:"Help Center"})}),e.jsx("li",{children:e.jsx(h,{to:"/privacy-policy",className:"hover:text-green-600",children:"Privacy"})}),e.jsx("li",{children:e.jsx(h,{to:"/faqs",className:"hover:text-green-600",children:"FAQs"})}),e.jsx("li",{children:e.jsx(h,{to:"/contact",className:"hover:text-green-600",children:"Contact Us"})})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold mb-3",children:"Contact"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{children:"hello@agrimeet.com"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:"+1 (555) 123-4567"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{children:"123 Farm Lane, AgriTown"})]})]})]})]}),e.jsx("div",{className:"border-t border-gray-100 mt-8 pt-8 text-sm text-gray-500 flex flex-col md:flex-row items-center justify-center gap-4",children:e.jsxs("div",{children:["Â© ",new Date().getFullYear()," AgriMeet. All rights reserved."]})})]})})]}):null}export{Pe as default};
