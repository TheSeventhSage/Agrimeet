import{D as u,r as i,d as h,j as e,e as w}from"./index-C7G52Pl0.js";import{D as F,E as W}from"./DashboardLayout-BvYMyTkM.js";import{F as D}from"./funnel-mF4Kl9_I.js";import{C as E}from"./clock-DxiVQocB.js";import{C as R}from"./chevron-left-MymTQRW8.js";import{C as T}from"./package-DupdcTls.js";import{X as L}from"./x-B7cmv6PP.js";import{C as z}from"./star-C80gymXW.js";import{U as P}from"./user-CwMqLLM3.js";import{S as q}from"./store-D_0Z2vXB.js";import{C as I}from"./circle-x-DQ-cXR03.js";import{C as U}from"./circle-check-big-28D-GMzn.js";import"./Logo-DmsMbJO2.js";import"./house-D2YIMOjc.js";import"./createLucideIcon-BK9ndVRo.js";import"./users-BmFRYmpR.js";import"./file-check-CHEU1kxb.js";import"./shield-check-DG8ZUOrZ.js";import"./circle-question-mark-DtC5Y68d.js";import"./message-circle-CLbYCCGy.js";import"./file-text-XKYnme41.js";import"./BackgroundArt-Ct9Pe-Iv.js";const $=async(l={})=>{try{return await u.get("/admin/withdrawals",{params:l})}catch(t){throw console.error("Error fetching withdrawals:",t),t}},M=async l=>{try{return await u.post(`/admin/withdrawl/${l}/approve`)}catch(t){throw console.error("Error approving withdrawal:",t),t}},G=async l=>{try{return await u.post(`/admin/withdrawl/${l}/reject`)}catch(t){throw console.error("Error rejecting withdrawal:",t),t}},g={getWithdrawals:$,approveWithdrawal:M,rejectWithdrawal:G},me=()=>{const[l,t]=i.useState([]),[j,y]=i.useState(!0),[o,c]=i.useState(!1),[a,N]=i.useState(null),[v,d]=i.useState(!1),[x,m]=i.useState({status:"",page:1}),[n,C]=i.useState({current_page:1,last_page:1,total:0,per_page:20});i.useEffect(()=>{p()},[x]);const p=async()=>{try{y(!0);const s=await g.getWithdrawals(x),r=s.data?.data?s.data:s;t(r.data||[]),C({current_page:r.meta?.current_page||1,last_page:r.meta?.last_page||1,total:r.meta?.total||0,per_page:r.meta?.per_page||20})}catch(s){console.error("Error loading withdrawals:",s),h("Failed to load withdrawal requests")}finally{y(!1)}},S=async s=>{if(window.confirm("Are you sure you want to approve this withdrawal? This will initiate the transfer."))try{c(!0),await g.approveWithdrawal(s),w("Withdrawal approved and sent for processing"),d(!1),p()}catch(r){h(r.response?.data?.message||"Failed to approve withdrawal")}finally{c(!1)}},_=async s=>{if(window.confirm("Are you sure you want to reject this withdrawal? Funds will be returned to the seller wallet."))try{c(!0),await g.rejectWithdrawal(s),w("Withdrawal rejected successfully"),d(!1),p()}catch(r){h(r.response?.data?.message||"Failed to reject withdrawal")}finally{c(!1)}},b=s=>{s>=1&&s<=n.last_page&&m(r=>({...r,page:s}))},A=(s,r)=>{m(k=>({...k,[s]:r,page:1}))},f=s=>{switch(s){case"completed":return"bg-green-100 text-green-700";case"pending":return"bg-yellow-100 text-yellow-700";case"processing":return"bg-blue-100 text-blue-700";case"rejected":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs(F,{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Withdrawal Requests"}),e.jsx("p",{className:"text-gray-600",children:"Manage and oversee seller payouts"})]})}),e.jsx("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm mb-6",children:e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-[200px]",children:[e.jsx(D,{className:"w-5 h-5 text-gray-400"}),e.jsxs("select",{value:x.status,onChange:s=>A("status",s.target.value),className:"w-full border-gray-300 rounded-lg focus:ring-brand-500 focus:border-brand-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsx("button",{onClick:()=>m({status:"",page:1}),className:"text-sm text-gray-500 hover:text-brand-600 font-medium ml-auto",children:"Clear Filters"})]})}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Seller"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Gateway / Ref"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-xs font-semibold text-gray-500 uppercase text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:j?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600"})})})}):l.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500",children:"No withdrawal requests found."})}):l.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-brand-100 flex items-center justify-center text-brand-700 font-medium text-sm",children:s.user?.name?.charAt(0)||"U"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:s.user?.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500",children:s.user?.seller?.store_name||"N/A"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("p",{className:"text-sm font-bold text-gray-900",children:["₦",parseFloat(s.amount).toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${f(s.status)}`,children:s.status})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm text-gray-900 capitalize",children:s.gateway||"-"}),e.jsx("p",{className:"text-xs text-gray-500 truncate max-w-[150px]",title:s.reference,children:s.reference||"-"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-500",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:new Date(s.created_at).toLocaleDateString()})]})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx("button",{onClick:()=>{N(s),d(!0)},className:"p-2 hover:bg-gray-100 rounded-lg text-gray-500 transition-colors",children:e.jsx(W,{className:"w-5 h-5"})})})]},s.id))})]})}),!j&&l.length>0&&e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:["Showing page ",n.current_page," of ",n.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(n.current_page-1),disabled:n.current_page===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(R,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>b(n.current_page+1),disabled:n.current_page===n.last_page,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(T,{className:"w-4 h-4"})})]})]})]}),v&&a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between bg-gray-50",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Withdrawal Details"}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:e.jsx(L,{className:"w-5 h-5 text-gray-500"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:`flex items-center gap-3 p-4 rounded-lg border ${f(a.status)} bg-opacity-10 border-opacity-20`,children:[e.jsx(z,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold capitalize",children:["Status: ",a.status]}),e.jsx("p",{className:"text-xs opacity-90",children:a.note||"No additional notes"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Transaction Info"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Amount"}),e.jsxs("span",{className:"font-bold text-gray-900",children:["₦",parseFloat(a.amount).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Date"}),e.jsx("span",{className:"text-gray-900",children:new Date(a.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Gateway"}),e.jsx("span",{className:"text-gray-900 capitalize",children:a.gateway||"N/A"})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Reference"}),e.jsx("span",{className:"text-gray-900 font-mono text-xs",children:a.reference||"N/A"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Seller Info"}),e.jsxs("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(P,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900 font-medium",children:a.user?.name})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(q,{className:"w-4 h-4 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:a.user?.seller?.store_name})]}),e.jsx("div",{className:"text-xs text-gray-500 pl-7",children:a.user?.email}),e.jsx("div",{className:"text-xs text-gray-500 pl-7",children:a.user?.seller?.business_phone_number})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>d(!1),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 font-medium",children:"Close"}),a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>_(a.id),disabled:o,className:"flex items-center gap-2 px-4 py-2 text-red-700 bg-white border border-red-200 rounded-lg hover:bg-red-50 font-medium disabled:opacity-50",children:[e.jsx(I,{className:"w-4 h-4"}),"Reject Request"]}),e.jsxs("button",{onClick:()=>S(a.id),disabled:o,className:"flex items-center gap-2 px-4 py-2 text-white bg-green-600 rounded-lg hover:bg-green-700 font-medium shadow-sm disabled:opacity-50",children:[o?e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx(U,{className:"w-4 h-4"}),"Approve & Pay"]})]})]})]})})]})};export{me as default};
