import{r as m,j as e,P as F,h as y,d as u,e as j}from"./index-BrJE6Ruv.js";import{a as I,B as k,C as z,g as B,m as q,S as w,b as O,d as H}from"./DashboardLayout-CbQpQ2VH.js";import{C as _}from"./circle-check-big-CzdoeDj5.js";import{c as J}from"./createLucideIcon-DTbf89oH.js";import{T as Y}from"./trash-2-DWTUZwMs.js";import{C as G}from"./chevron-left-DyrGgcS9.js";import{C as K,P as M}from"./x-89xIXrzd.js";import{T as Q}from"./trending-up-D4vS7VFI.js";import{C as N,S}from"./star-D0UWI2kz.js";import{C as v}from"./credit-card-De6BP3Px.js";import"./Logo-yv9J0Zw_.js";import"./house-B5NBqIRK.js";import"./users-Btkg261Z.js";import"./file-check-BlT-5aXD.js";import"./circle-question-mark-DdVU0ul4.js";import"./message-circle-CfRGLCSX.js";import"./file-text-DhmWdPlz.js";import"./info-D8IKXDkN.js";import"./user-BoLJHLaW.js";import"./BackgroundArt-Cv4ql44m.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],W=J("refresh-cw",V),X=r=>{const l=new Date,o=new Date(r),g=Math.floor((l-o)/1e3),s={year:31536e3,month:2592e3,week:604800,day:86400,hour:3600,minute:60};for(const[f,c]of Object.entries(s)){const x=Math.floor(g/c);if(x>=1)return`${x} ${f}${x>1?"s":""} ago`}return"Just now"},Z=r=>({new_order:w,order:w,orders:w,seller_payment_confirmed:v,wallet:v,payment:v,stock:M,inventory:M,kyc:N,verification:N,review:S,reviews:S,system:k,success:_,info:N,trending:Q})[r?.toLowerCase()]||k,ee=r=>({new_order:"bg-blue-100 text-blue-600",order:"bg-blue-100 text-blue-600",orders:"bg-blue-100 text-blue-600",seller_payment_confirmed:"bg-green-100 text-green-600",wallet:"bg-green-100 text-green-600",payment:"bg-green-100 text-green-600",stock:"bg-purple-100 text-purple-600",inventory:"bg-purple-100 text-purple-600",kyc:"bg-yellow-100 text-yellow-600",verification:"bg-yellow-100 text-yellow-600",review:"bg-orange-100 text-orange-600",reviews:"bg-orange-100 text-orange-600",system:"bg-gray-100 text-gray-600",success:"bg-green-100 text-green-600",info:"bg-blue-100 text-blue-600",trending:"bg-brand-100 text-brand-600"})[r?.toLowerCase()]||"bg-gray-100 text-gray-600",ae=r=>{const l=r.data?.type||"",o=r.data?.order_number||"";switch(l){case"new_order":return`New Order ${o}`;case"seller_payment_confirmed":return`Payment Confirmed - ${o}`;default:return l.split("_").map(g=>g.charAt(0).toUpperCase()+g.slice(1)).join(" ")}},Ne=()=>{const[r,l]=m.useState([]),[o,g]=m.useState(0),[s,f]=m.useState({current_page:1,last_page:1,total:0,per_page:15}),[c,x]=m.useState(!0),[C,A]=m.useState(!0),[h,p]=m.useState(null),i=async(a=1)=>{x(!0);try{const n=(await B(a,s.per_page)).data;n&&n.success&&n.data&&(l(n.data.notifications||[]),g(n.data.unread_count||0),f(n.data.pagination||s))}catch(t){console.error("Error fetching notifications:",t),t.response?.status===401||t.response?.status===403?(u("Session expired. Please login again."),window.location.href="/login"):u("Failed to load notifications. Please try again.")}finally{x(!1),A(!1)}};m.useEffect(()=>{i()},[]);const R=async a=>{p(a);try{const t=await O(a);console.log("Mark as read response:",t),await i(s.current_page),j("Notification marked as read")}catch(t){console.error("Error marking notification as read:",t),u("Failed to mark notification as read"),await i(s.current_page)}finally{p(null)}},P=async()=>{if(o!==0){p("mark-all");try{const a=await q();console.log("Mark all as read response:",a),await i(s.current_page),j("All notifications marked as read")}catch(a){console.error("Error marking all notifications as read:",a),u("Failed to mark all notifications as read"),await i(s.current_page)}finally{p(null)}}},T=async a=>{if(confirm("Are you sure you want to delete this notification?")){p(a);try{const t=await H(a);console.log("Delete notification response:",t),await i(s.current_page),j("Notification deleted")}catch(t){console.error("Error deleting notification:",t),u("Failed to delete notification"),await i(s.current_page)}finally{p(null)}}},$=()=>{i(s.current_page)},L=a=>{a>=1&&a<=s.last_page&&(i(a),window.scrollTo({top:0,behavior:"smooth"}))};return C?e.jsx(F,{message:"Loading your notifications..."}):e.jsx(I,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between flex-col gap-4 px-4 md:items-center md:flex-row md:px-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Notifications"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Stay updated with your business activities"})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[o>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-brand-50 rounded-lg",children:[e.jsx(k,{className:"w-4 h-4 text-brand-600"}),e.jsxs("span",{className:"text-sm font-semibold text-brand-600",children:[o," Unread"]})]}),o>0&&e.jsxs("button",{onClick:P,disabled:h==="mark-all",className:"flex  items-center gap-2 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[h==="mark-all"?e.jsx(y,{size:"sm",message:""}):e.jsx(_,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mark All Read"})]}),e.jsxs("button",{onClick:$,disabled:c,className:"flex items-center gap-2 px-4 py-2 bg-brand-600 text-white rounded-lg hover:bg-brand-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(W,{className:`w-4 h-4 ${c?"animate-spin":""}`}),e.jsx("span",{className:"text-sm font-medium",children:"Refresh"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-xs border border-gray-100",children:[c&&!C?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(y,{size:"lg",message:"Loading notifications..."})}):r.length>0?e.jsx("div",{className:"divide-y divide-gray-100",children:r.map(a=>{const t=a.data||{},n=t.type||"",D=Z(n),E=ee(n),b=!a.read_at;return e.jsx("div",{className:`p-6 hover:bg-gray-50 transition-colors ${b?"bg-blue-50/30":""}`,children:e.jsxs("div",{className:"flex flex-col items-start gap-4 md:flex-row",children:[e.jsx("div",{className:`p-3 rounded-lg ${E} flex-shrink-0`,children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex md:flex-row flex-col items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:ae(a)}),b&&e.jsx("span",{className:"w-2 h-2 bg-brand-500 rounded-full flex-shrink-0"})]}),e.jsx("p",{className:"text-gray-700 text-sm leading-relaxed mb-2 break-all",children:t.message||"No message available"}),t.products&&t.products.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.products.map((d,U)=>e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg px-2 py-1",children:[d.thumbnail&&e.jsx("img",{src:d.thumbnail,alt:d.name,className:"w-6 h-6 rounded object-cover"}),e.jsxs("span",{className:"text-xs text-gray-700",children:[d.name," ",d.variant_name?`(${d.variant_name})`:""," × ",d.quantity]})]},U))}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500",children:[e.jsx("span",{children:X(a.created_at)}),n&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:n.replace(/_/g," ")})]}),t.customer_name&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Customer: ",t.customer_name]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[b&&e.jsx("button",{onClick:()=>R(a.id),disabled:h===a.id,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Mark as read",children:h===a.id?e.jsx(y,{size:"sm"}):e.jsx(z,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(a.id),disabled:h===a.id,className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Delete notification",children:e.jsx(Y,{className:"w-4 h-4"})})]})]})})]})},a.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 px-6",children:[e.jsx("div",{className:"p-4 bg-green-50 rounded-full mb-4",children:e.jsx(_,{className:"w-12 h-12 text-green-500"})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"You're All Caught Up!"}),e.jsx("p",{className:"text-gray-600 text-center max-w-md",children:"No new notifications. Check back later for updates on orders, payments, and more."})]}),r.length>0&&s.last_page>1&&e.jsxs("div",{className:"flex flex-col gap-2 items-center justify-between px-6 py-4 border-t border-gray-100 md:flex-row md:gap-0",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",s.current_page," of ",s.last_page,e.jsxs("span",{className:"ml-2 text-gray-500",children:["(",s.total," total notifications)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>L(s.current_page-1),disabled:s.current_page===1||c,className:"flex items-center gap-1 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(G,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Previous"})]}),e.jsxs("button",{onClick:()=>L(s.current_page+1),disabled:s.current_page===s.last_page||c,className:"flex items-center gap-1 px-4 py-2 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{className:"text-sm font-medium",children:"Next"}),e.jsx(K,{className:"w-4 h-4"})]})]})]})]})]})})};export{Ne as default};
