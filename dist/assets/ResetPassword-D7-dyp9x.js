import{a as P,u as N,b as S,f as _,r as i,j as e,L as C}from"./index-BOLkSH9S.js";import{A as f}from"./AuthLayout-DzJTVFFc.js";import{T as k}from"./TextFields-zAyCwOkt.js";import{P as w}from"./PasswordField-6x4nXBmE.js";import{B as h}from"./Button-DPYyXRjf.js";import"./Logo-g0xKsfJ_.js";import"./BackgroundArt-ChQV54k0.js";import"./house-CbQ0kLy2.js";import"./createLucideIcon-Df3o3GTg.js";function Y(){const{token:l}=P(),[u]=N(),p=S(),{resetPassword:x}=_(),[r,d]=i.useState({email:"",password:"",password_confirmation:""}),[t,a]=i.useState({}),[b,g]=i.useState(!1),[j,y]=i.useState(!1);i.useEffect(()=>{const o=u.get("email"),s=localStorage.getItem("reset_email");o?d(n=>({...n,email:o})):s&&d(n=>({...n,email:s}))},[u]);const m=o=>{const{name:s,value:n}=o.target;d(c=>({...c,[s]:n})),t[s]&&a(c=>({...c,[s]:""}))},v=async o=>{if(o.preventDefault(),a({}),!l){a({general:"Invalid or missing reset token."});return}if(r.password!==r.password_confirmation){a({password:"Passwords do not match"});return}if(r.password.length<8){a({password:"Password must be at least 8 characters"});return}g(!0);try{await x({token:l,email:r.email,password:r.password,password_confirmation:r.password_confirmation}),localStorage.removeItem("reset_email"),y(!0),setTimeout(()=>p("/login"),3e3)}catch(s){s.errors?a(s.errors):s.message?a({general:s.message}):a({general:"Failed to reset password. Please try again."})}finally{g(!1)}};return j?e.jsx(f,{title:"Password Reset",subtitle:"Your password has been updated",children:e.jsxs("div",{className:"text-center space-y-6",children:[e.jsxs("div",{className:"bg-green-50 text-green-700 p-4 rounded-lg border border-green-100",children:[e.jsx("p",{className:"font-medium",children:"Success!"}),e.jsx("p",{className:"text-sm mt-1",children:"You will be redirected to the login page shortly."})]}),e.jsx(h,{onClick:()=>p("/login"),className:"w-full",children:"Login Now"})]})}):e.jsx(f,{title:"Reset Password",subtitle:"Create a new strong password",footer:e.jsx(C,{to:"/login",className:"text-gray-900 font-medium hover:underline",children:"Back to sign in"}),children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[t.general&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg border border-red-100",children:t.general}),!l&&e.jsx("div",{className:"text-sm text-amber-700 bg-amber-50 p-3 rounded-lg border border-amber-100",children:"Warning: Invalid link structure. Token missing."}),e.jsx(k,{label:"Email Address",name:"email",type:"email",value:r.email,onChange:m,error:t.email,placeholder:"Confirm your email",required:!0,readOnly:!0,className:"bg-gray-100 cursor-not-allowed opacity-75"}),e.jsx(w,{label:"New Password",name:"password",value:r.password,onChange:m,error:t.password,placeholder:"Min 8 chars"}),e.jsx(w,{label:"Confirm Password",name:"password_confirmation",value:r.password_confirmation,onChange:m,error:t.password_confirmation,placeholder:"Re-enter password"}),e.jsx(h,{type:"submit",loading:b,className:"w-full",disabled:!l,children:"Reset Password"})]})})}export{Y as default};
