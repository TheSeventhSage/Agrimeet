import{r as l,b as F,f as D,j as e,s as R,L as h,d as c}from"./index-BOLkSH9S.js";import{A as x}from"./AuthLayout-DzJTVFFc.js";import{T as m}from"./TextFields-zAyCwOkt.js";import{P as b}from"./PasswordField-6x4nXBmE.js";import{B as v}from"./Button-DPYyXRjf.js";import{r as A}from"./validation-BVSLfvBr.js";import{h as L}from"./routingManager-C4lI7ZM2.js";import"./Logo-g0xKsfJ_.js";import"./BackgroundArt-ChQV54k0.js";import"./house-CbQ0kLy2.js";import"./createLucideIcon-Df3o3GTg.js";const u="user_registration_persistence";function K(){const[r,f]=l.useState({first_name:"",last_name:"",phone_number:"",email:"",password:"",password_confirmation:"",terms_accepted:!1}),[s,i]=l.useState({}),[y,j]=l.useState(""),[w,g]=l.useState(!1),[N,_]=l.useState(!1),k=F(),{register:C}=D(),p=l.useRef(!0);l.useEffect(()=>{if(p.current){const a=localStorage.getItem(u);if(a)try{const t=JSON.parse(a);f(o=>({...o,...t}))}catch(t){console.error("Failed to restore registration data",t)}p.current=!1}else{const a={...r};delete a.password,delete a.password_confirmation,localStorage.setItem(u,JSON.stringify(a))}},[r]);const n=a=>{const{name:t,value:o,type:P,checked:E}=a.target;f(d=>({...d,[t]:P==="checkbox"?E:o})),s[t]&&i(d=>({...d,[t]:""}))},S=async a=>{a.preventDefault();const t=A(r);if(Object.keys(t).length>0){i(t),c("Please correct the errors in the form");return}g(!0),i({});try{await C(r),localStorage.removeItem(u),_(!0),j("Redirecting..."),setTimeout(()=>{L()},1e3)}catch(o){o.errors?(i(o.errors),c("Registration failed. Please check the form for errors.")):o.message?(i({general:o.message}),c(o.message)):(i({general:"Registration failed. Please try again."}),c("Registration failed. Please try again."))}finally{g(!1)}};return N?e.jsx(x,{title:"Registration Successful!",subtitle:"Please check your email for the verification code.",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We've sent a verification code to your email address. Please check your inbox and follow the instructions to complete your registration."}),e.jsx("p",{children:y}),e.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Email: ",R.getUserData()?.email||r.email]}),e.jsx(v,{className:"w-full",onClick:()=>k("/verify-otp"),children:"Verify Account Now"})]})}):e.jsx(x,{className:"py-20 md:py-16",title:"Create Your Account",subtitle:"Join thousands of farmers and buyers on our platform",footer:e.jsxs("p",{children:["Already have an account?"," ",e.jsx(h,{className:"text-brand-600 font-medium hover:underline",to:"/login",children:"Sign in"})]}),children:e.jsxs("form",{onSubmit:S,className:"space-y-4",children:[s.general&&e.jsx("div",{className:"text-sm text-red-600 bg-red-50 p-3 rounded-lg",children:s.general}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(m,{label:"First Name",name:"first_name",placeholder:"John",value:r.first_name,onChange:n,error:s.first_name}),e.jsx(m,{label:"Last Name",name:"last_name",placeholder:"Doe",value:r.last_name,onChange:n,error:s.last_name})]}),e.jsx(m,{label:"Phone Number",name:"phone_number",placeholder:"+23489806755",value:r.phone_number,onChange:n,error:s.phone_number}),e.jsx(m,{label:"Email",name:"email",type:"email",placeholder:"john@example.com",value:r.email,onChange:n,error:s.email}),e.jsx(b,{label:"Password",name:"password",placeholder:"Create a strong password",value:r.password,onChange:n,error:s.password}),e.jsx(b,{label:"Confirm Password",name:"password_confirmation",placeholder:"Confirm your password",value:r.password_confirmation,onChange:n,error:s.password_confirmation}),e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"flex items-center h-5",children:e.jsx("input",{id:"terms",name:"terms_accepted",type:"checkbox",checked:r.terms_accepted,onChange:n,className:`\r
        appearance-none h-5 w-5 border border-gray-300 rounded\r
        bg-white shrink-0 cursor-pointer\r
        checked:bg-brand-600 checked:border-brand-600\r
        focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-brand-500\r
        checked:bg-[url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2020%2020%22%20fill%3D%22%23fff%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M16.707%205.293a1%201%200%20010%201.414l-8%208a1%201%200%2001-1.414%200l-4-4a1%201%200%20011.414-1.414L8%2012.586l7.293-7.293a1%201%200%20011.414%200z%22%20clip-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E')]\r
        checked:bg-center checked:bg-no-repeat\r
    `})}),e.jsxs("div",{className:"ml-3 text-sm",children:[e.jsxs("label",{htmlFor:"terms",className:"text-gray-700",children:["I agree to the"," ",e.jsx(h,{to:"/terms",className:"text-brand-600 hover:text-brand-500",children:"Terms and Conditions"})," ","and"," ",e.jsx(h,{to:"/privacy-policy",className:"text-brand-600 hover:text-brand-500",children:"Privacy Policy"})]}),s.terms_accepted&&e.jsx("p",{className:"text-red-600 mt-1",children:s.terms_accepted})]})]}),e.jsx(v,{type:"submit",loading:w,className:"w-full",children:"Create Account"})]})})}export{K as default};
